#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <locale.h>
#include <stdlib.h>
#include <conio.h>
#include <math.h>
#include <time.h>

double* full_elements(double* ptr_array, int n)
{
	srand((unsigned)time(NULL));
	for (int i = 0; i < n; i++)
		ptr_array[i] = -50 + rand() % 101 + rand() / (double)RAND_MAX;
	return ptr_array;
}

double* calc_elements(double* ptr_array, int n)
{
	for (int i = 0; i < n; i++)
	{
		ptr_array[i] = ceil(ptr_array[i]);
	}
	return ptr_array;
}

void put_elements(double* ptr_array, int size)
{
	for (int i = 0; i < size; i++)
		printf("\n a[%d]= %.1f", i, ptr_array[i]);
	return 0;
}

double* vtoroe_zadanie(double* ptr_array, int size)
{
	srand((unsigned)time(NULL));
	for (int i = 0; i < size; i++)
		ptr_array[i] = -1 + rand() % 2 + rand() / (double)RAND_MAX;
	return ptr_array;
}

void udal_otric(double* ptr_array, int* size)
{
	int k = 0;
	for (int i = 0; i < *size; i++)
	{
		if (ptr_array[i] >= 0)
			ptr_array[k++] = ptr_array[i];
	}
	*size = k;
}

double* insert(double* ptr_array, int* size, int index, double num)
{
	*size += 1;
	ptr_array = (double*)realloc(ptr_array, (*size) * sizeof(double));
	for (int i = *size - 1; i > index; i--)
	{
		ptr_array[i] = ptr_array[i - 1];
	}
	ptr_array[index] = num;
	return ptr_array;
}

double* vstavka_polozhi(double* ptr_array, int* size)
{
	for (int i = 0; i < *size; i++) {
		if (ptr_array[i] > 0) {
			ptr_array = insert(ptr_array, size, i + 1, -999);
			i++; 
		}
	}
	return ptr_array;
}

int main()
{
	setlocale(LC_CTYPE, "RUS");
	double* ptr_array;

	int size,index;
	printf("Размер массива > ");
	scanf("%d", &size);

	ptr_array = (double*)malloc(size * sizeof(double));

	if (ptr_array == NULL) {

		puts("error");

		return -1;
	}
	full_elements(ptr_array, size);
		
	put_elements(ptr_array, size); printf("\n");
	printf("Начальный массив\n");

	calc_elements(ptr_array, size);

	put_elements(ptr_array, size); printf("\n");
	printf("Обработанный массив\n");

	vtoroe_zadanie(ptr_array, size);

	put_elements(ptr_array, size); printf("\n");
	printf("V2 начальный массив\n");

	udal_otric(ptr_array, &size);

	put_elements(ptr_array, size); printf("\n");
	printf("V2 Обработанный массив\n");
	
	ptr_array = vstavka_polozhi(ptr_array, &size);
	put_elements(ptr_array, size); printf("\n");
	printf("Массив с элементом '-999' после положительного числа\n");

	free(ptr_array);
}
